{% extends 'base.html' %}
{% block title %}
Product Management
{% endblock %}
{% block head %}
<script>
    // Function to open the Add modal
    function openAdd() {
        document.getElementById("popupAdd").style.display = "block";
        document.getElementById("overlay").style.display = "block";
    }

    // Function to close the Add modal
    function closeAdd() {
        document.getElementById("popupAdd").style.display = "none";
        document.getElementById("overlay").style.display = "none";
    }
</script>
{% endblock %}
{% block content %}
<div class="super_container" style="margin-top: 35px; padding: 20px; height: 100vh;  ">
    <br>
    <div class="heading-button-container">
        <h1>Product Management</h1>
        <button type="button" class="btn btn-outline-secondary" onclick="openAdd()">Add product</button>
    </div>
    <br>
    <h2>Products</h2>
    <!-- should edit these classes in table to have a consistent name  -->

    <div class="customer-table-container">
        <table class="employee-table">
            <thead class="employee-table-header">
                <tr>
                    <th>Product ID</th>
                    <th>Name</th>
                    <th>Price</th>
                    <th>Description</th>
                    <th>Category</th>
                    <th>Actions</th>
                </tr>
            </thead>

            <tbody class="employee-table-body">
                {% for product in products %}
                <tr class="employee-table-row">
                    <td class="employee-table-cell">{{ product.product_id }}</td>
                    <td class="employee-table-cell">{{ product.product_name }}</td>
                    <td class="employee-table-cell">{{ product.price }}</td>
                    <td class="employee-table-cell">{{ product.description }}</td>
                    <td class="employee-table-cell">{{ product.category }}
                    </td>
                    <td class="employee-table-cell">
                        <div class="d-flex align-items-center">
                            <button class="btn btn btn-outline-primary btn-sm me-2" onclick="openUpdate{{ product.product_id }}()">
                                <a>
                                    <i class="fas fa-edit"></i>
                                </a>
                            </button>
                            <form method="POST" action="{{ url_for('delete_product', product_id=product.product_id) }}"
                                onsubmit="return confirm('Are you sure you want to delete this product?')">
                                
                                <button type="submit" class="btn btn btn-outline-danger btn-sm">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </form>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
    </div>

    <div class="popup" id="popupAdd">
        <form action="{{ url_for('add_product') }}" method="POST" class="popup-form">
            {{ add_form.csrf_token() }}
            {{ add_form.hidden_tag() }}
            <div style="display: flex; flex-direction: column; align-items: center;">
                <h1>
                  Add Product
                </h1>
            </div>
            <br>
            {{ add_form.product_name.label() }}
            {{ add_form.product_name(class = "form-control", placeholder="Enter Product Name") }}
            <br>
            {{ add_form.price.label() }}
            {{ add_form.price(class = "form-control", placeholder="in decimal") }}
            <br>
            {{ add_form.description.label() }}
            {{ add_form.description(class = "form-control") }}
            <br>
            {{ add_form.category.label() }}
            {{ add_form.category(class = "form-control") }}
            <br>
            {{ add_form.submit(class = "btn btn-outline-primary") }}
            <button type="button" class="btn btn-danger" onclick="closeAdd()">Cancel</button>
        </form>
    </div>

    {% for product in products %}
    <div class="popup" id="popupUpdate-{{product.product_id}}">
        <form action="{{ url_for('edit_product', product_id=product.product_id) }}" method="POST" class="popup-form">
            {{ edit_form.csrf_token() }}
            {{ edit_form.hidden_tag() }}
            <div style="display: flex; flex-direction: column; align-items: center;">
                <h1>
                  Edit Employee
                </h1>
            </div>
            <br>
            {{ edit_form.product_name.label() }}
            {{ edit_form.product_name(class = "form-control", placeholder="Enter Product Name") }}
            <br>
            {{ edit_form.price.label() }}
            {{ edit_form.price(class = "form-control", placeholder="in decimal") }}
            <br>
            {{ edit_form.description.label() }}
            {{ edit_form.description(class = "form-control") }}
            <br>
            {{ edit_form.category.label() }}
            {{ edit_form.category(class = "form-control") }}
            <br>
            {{ edit_form.submit(class = "btn btn-outline-primary") }}
            <button type="button" class="btn btn-danger" onclick="closeUpdate{{ product.product_id }}()">Cancel</button>
        </form>
    </div>
    {% endfor %}

</div>



<!-- overlay  -->
<div id="overlay" class="overlay"></div>
{% endblock %}

{% block script %}

{% for product in products %}
<script>
  // Function to open the popup form
  function openUpdate{{ product.product_id }}() {
    document.getElementById("popupUpdate-{{product.product_id}}").style.display = "block";
    document.getElementById("overlay").style.display = "block";
  }

  // Function to close the popup form
  function closeUpdate{{ product.product_id }}() {
    document.getElementById("popupUpdate-{{product.product_id}}").style.display = "none";
    document.getElementById("overlay").style.display = "none";
  }

</script>
{% endfor %}

{% endblock %}